<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="Professional TDS & GST deduction calculator for freelancers, contractors, and businesses. Calculate deductions, track bills, export to Excel/PDF, and work offline." />
    <meta name="keywords"
        content="TDS calculator, GST calculator, tax deduction, freelance, contractor, invoice, billing" />
    <meta name="author" content="Subhan Raj" />

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4CAF50" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="TDS Calculator" />
    <meta name="application-name" content="TDS Calculator" />
    <meta name="msapplication-TileColor" content="#4CAF50" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="msapplication-config" content="/browserconfig.xml" />

    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/assets/logo.svg" />
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/ios/32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/ios/16.png" />
    <link rel="shortcut icon" href="/assets/logo.png" />

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/ios/180.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="/assets/icons/ios/167.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/ios/152.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/ios/144.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/ios/120.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/ios/114.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/ios/76.png" />
    <link rel="apple-touch-icon" href="/assets/icons/ios/180.png" />

    <title>TDS & GST Deduction Calculator</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="canonical" href="https://tds-deduction-calculator.pages.dev/" />

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "TDS & GST Deduction Calculator",
      "alternateName": "TDS Calculator",
      "url": "https://tds-deduction-calculator.pages.dev",
      "description": "Professional TDS & GST deduction calculator for freelancers, contractors, and businesses. Calculate tax deductions, track multiple bills, export to Excel/PDF, and work offline.",
      "applicationCategory": "FinanceApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "INR"
      },
      "author": {
        "@type": "Person",
        "name": "Subhan Raj",
        "url": "https://github.com/SubhanRaj"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "5",
        "ratingCount": "1"
      },
      "featureList": [
        "TDS and GST calculation",
        "Bill management",
        "Export to Excel and PDF",
        "Offline support",
        "Progressive Web App",
        "Local data storage",
        "Multiple bill tracking",
        "Summary dashboard"
      ],
      "screenshot": "https://tds-deduction-calculator.pages.dev/assets/screenshots/1920x1080.png",
      "softwareVersion": "1.0.0",
      "datePublished": "2025-12-12",
      "inLanguage": "en-IN",
      "countryOfOrigin": {
        "@type": "Country",
        "name": "India"
      }
    }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/css/bootstrap.min.css"
        integrity="sha512-2bBQCjcnw658Lho4nlXJcc6WkV/UxpE/sAokbXPxQNGqmNdQrWqtw26Ns9kFF/yG792pKR1Sx8/Y1Lf1XN4GKA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.css"
        integrity="sha512-oe8OpYjBaDWPt2VmSFR+qYOdnTjeV9QPLJUeqZyprDEQvQLJ9C5PCFclxwNuvb/GQgQngdCXzKSFltuHD3eCxA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.23.0/sweetalert2.min.css"
        integrity="sha512-Ivy7sPrd6LPp20adiK3al16GBelPtqswhJnyXuha3kGtmQ1G2qWpjuipfVDaZUwH26b3RDe8x707asEpvxl7iA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="style.css" />
</head>

<body class="bg-light p-4">
    <div class="container bg-white p-4 shadow rounded">
        <h2 class="mb-4 text-center">TDS & GST Deduction Calculator</h2>

        <!-- Company Info Section -->
        <div class="mb-4 p-3 bg-light border rounded">
            <div class="row">
                <div class="col-md-6 col-12 mb-2">
                    <label class="form-label"><strong>Company/Your Name:</strong></label>
                    <input type="text" id="companyName" class="form-control" placeholder="Enter company or your name" />
                </div>
                <div class="col-md-6 col-12 mb-2">
                    <label class="form-label"><strong>GSTN Number:</strong></label>
                    <input type="text" id="panNumber" class="form-control" placeholder="Optional GSTN number"
                        maxlength="15" />
                </div>
            </div>
        </div>

        <!-- Summary Dashboard -->
        <div class="mb-4 p-3 bg-info bg-opacity-10 border border-info rounded" id="summaryDashboard"
            style="display: none;">
            <h5 class="mb-3"><i class="fas fa-chart-line"></i> Summary Dashboard</h5>
            <div class="row text-center">
                <div class="col-md-3 col-6 mb-2">
                    <div class="p-2 bg-white rounded shadow-sm">
                        <small class="text-muted d-block">Total Bills</small>
                        <strong class="fs-5 text-primary" id="dashTotalBills">0</strong>
                    </div>
                </div>
                <div class="col-md-3 col-6 mb-2">
                    <div class="p-2 bg-white rounded shadow-sm">
                        <small class="text-muted d-block">Avg. Deduction</small>
                        <strong class="fs-5 text-success" id="dashAvgDeduction">0%</strong>
                    </div>
                </div>
                <div class="col-md-3 col-6 mb-2">
                    <div class="p-2 bg-white rounded shadow-sm">
                        <small class="text-muted d-block">Highest Bill</small>
                        <strong class="fs-5 text-warning" id="dashHighest">â‚¹0</strong>
                    </div>
                </div>
                <div class="col-md-3 col-6 mb-2">
                    <div class="p-2 bg-white rounded shadow-sm">
                        <small class="text-muted d-block">Date Range</small>
                        <strong class="fs-6 text-secondary" id="dashDateRange">-</strong>
                    </div>
                </div>
            </div>
        </div>

        <div class="mb-4 p-3 bg-light border rounded justify-content-center">
            <p class="text-justify">
                This is a simple tool to calculate TDS (Tax Deducted at Source) and
                GST (Goods and Services Tax) deduction from the payments received from
                the payments made by government or private companies which are subject
                to TDS and GST deduction. You can add multiple bills and calculate the
                total deduction and received amount as well as the individual
                deduction for each bill.
            </p>
        </div>

        <div class="mb-4 p-3 bg-light border rounded">
            <div class="row">
                <div class="col-md-4 col-12">
                    <label class="form-label"><strong>Enter Total Billed Amount:</strong></label>
                    <input type="number" id="manualBilled" class="form-control mb-2" min="0" step="0.01" />
                </div>
                <div class="col-md-4 col-12">
                    <label class="form-label"><strong>Enter Total Received Amount:</strong></label>
                    <input type="number" id="manualReceived" class="form-control mb-2" min="0" step="0.01" />
                </div>
                <div class="col-md-4 col-12">
                    <label class="form-label"><strong>Deduction Percentage:</strong></label>
                    <select id="deductionPercentageSelect" class="form-select mb-2" onchange="handlePercentageChange()">
                        <option value="auto">Auto (Default Logic)</option>
                        <option value="2.24">2.24% (TDS Only)</option>
                        <option value="2.40">2.40%</option>
                        <option value="2.43">2.43%</option>
                        <option value="4.24">4.24% (2% GST + 2.24% TDS)</option>
                        <option value="custom">Custom Percentage</option>
                    </select>
                    <input type="number" id="customPercentage" class="form-control" placeholder="Enter custom %"
                        step="0.01" style="display: none;" onblur="applyCustomPercentage()" />
                </div>
            </div>
            <div class="row mt-3 text-center">
                <div class="col-12 d-flex flex-column flex-md-row gap-2">
                    <button onclick="manualCalculation()" class="btn btn-primary flex-grow-1 mb-2 mb-md-0">
                        Calculate
                    </button>
                    <button onclick="clearFields()" class="btn btn-secondary flex-grow-1">
                        Clear
                    </button>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-6 col-12">
                    <strong>Deducted Amount:</strong> â‚¹<span id="manualDeduction">0.00</span>
                </div>
                <div class="col-md-6 col-12">
                    <strong>Deduction Percentage & Type:</strong>
                    <span id="manualDeductionPercentage">0.00%</span>
                </div>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-bordered" id="billTable">
                <thead class="table-light text-center">
                    <tr>
                        <th style="width: 50px;">
                            <input type="checkbox" id="selectAll" onchange="toggleSelectAll()" title="Select all bills"
                                aria-label="Select all bills">
                        </th>
                        <th>Bill Number</th>
                        <th>Date</th>
                        <th>Bill Amount (â‚¹)</th>
                        <th>Deduction (â‚¹)</th>
                        <th>Deduction Percentage & Type</th>
                        <th>Amount Received (â‚¹)</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="text-center my-3 d-flex flex-column flex-md-row gap-2 justify-content-center">
            <button onclick="addRow()" class="btn btn-primary mb-2 mb-md-0" title="Ctrl/Cmd + N">
                <i class="fas fa-plus"></i> Add Bill
            </button>
            <button onclick="deleteSelectedRows()" class="btn btn-warning mb-2 mb-md-0" id="deleteSelectedBtn"
                style="display: none;">
                <i class="fas fa-trash-alt"></i> Delete Selected
            </button>
            <button onclick="exportToExcel()" class="btn btn-success mb-2 mb-md-0" title="Ctrl/Cmd + E">
                <i class="fas fa-file-excel"></i> Export to Excel
            </button>
            <button onclick="exportToPDF()" class="btn btn-danger mb-2 mb-md-0" title="Ctrl/Cmd + P">
                <i class="fas fa-file-pdf"></i> Export to PDF
            </button>
            <button onclick="importFromExcel()" class="btn btn-info mb-2 mb-md-0">
                <i class="fas fa-file-upload"></i> Import Excel
            </button>
            <button onclick="window.print()" class="btn btn-secondary no-print">
                <i class="fas fa-print"></i> Print
            </button>
            <button onclick="copyToClipboard()" class="btn btn-outline-primary">
                <i class="fas fa-copy"></i> Copy Totals
            </button>
            <button onclick="showInstallPrompt()" class="btn btn-outline-success no-print" id="installAppBtn"
                style="display: none;" title="Install this app">
                <i class="fas fa-download"></i> Install App
            </button>
        </div>
        <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;"
            onchange="handleExcelImport(event)" />

        <div class="mt-4 p-3 bg-light border rounded text-center">
            <div class="row">
                <div class="col-md-4 col-12">
                    <strong>Total Billed Amount:</strong> â‚¹<span id="totalBilled">0.00</span>
                </div>
                <div class="col-md-4 col-12">
                    <strong>Total Deducted:</strong> â‚¹<span id="totalDeducted">0.00</span>
                </div>
                <div class="col-md-4 col-12">
                    <strong>Total Amount Received:</strong> â‚¹<span id="totalReceived">0.00</span>
                </div>
            </div>
            <div class="mt-2">
                <strong>Total Deduction Percentage & Type:</strong>
                <span id="totalDeductionPercentage">0.00%</span>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/js/all.min.js"
        integrity="sha512-6BTOlkauINO65nLhXhthZMtepgJSghyimIalb+crKRPhvhmsCdnIuGcVbR5/aQY2A+260iC1OPy1oCdB6pSSwQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/js/bootstrap.bundle.min.js"
        integrity="sha512-HvOjJrdwNpDbkGJIG2ZNqDlVqMo77qbs4Me4cah0HoDrfhrbA+8SBlZn1KrvAQw7cILLPFJvdwIgphzQmMm+Pw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.23.0/sweetalert2.min.js"
        integrity="sha512-pnPZhx5S+z5FSVwy62gcyG2Mun8h6R+PG01MidzU+NGF06/ytcm2r6+AaWMBXAnDHsdHWtsxS0dH8FBKA84FlQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js"
        integrity="sha512-lbwH47l/tPXJYG9AcFNoJaTMhGvYWhVM9YI43CT+uteTRRaiLCui8snIgyAN8XWgNjNhCqlAUdzZptso6OCoFQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"
        integrity="sha512-r22gChDnGvBylk90+2e/ycr3RVrDi8DIOkIGNhJlKfuyQM4tIRAI062MaV8sfjQKYVGjOBaZBOA87z+IhZE9DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.3/jspdf.umd.min.js"
        integrity="sha512-+EeCylkt9WHJk5tGJxYdecHOcXFRME7qnbsfeMsdQL6NUPYm2+uGFmyleEqsmVoap/f3dN/sc3BX9t9kHXkHHg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/5.0.2/jspdf.plugin.autotable.min.js"
        integrity="sha512-JizZOUNesiGhMcp9fsA/9W31FOat6QysBM8hSj6ir8iIANIUJ2mhko7Lo1+j0ErftmJ8SebMZLm9iielKjeIEQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }

        // Handle install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;

            // Show install button
            const installBtn = document.getElementById('installAppBtn');
            if (installBtn) {
                installBtn.style.display = 'inline-block';
            }

            // Show custom install popup after a delay (only once)
            setTimeout(() => {
                if (deferredPrompt && !localStorage.getItem('installPromptShown')) {
                    showInstallPrompt();
                }
            }, 3000);
        });

        function showInstallPrompt() {
            if (!deferredPrompt) return;

            // Check if SweetAlert2 is loaded
            if (typeof Swal === 'undefined') {
                console.error('SweetAlert2 not loaded yet');
                return;
            }

            // Mark as shown so it doesn't repeat
            localStorage.setItem('installPromptShown', 'true');

            Swal.fire({
                title: 'ðŸ“± Install App',
                html: `
                    <div style="text-align: left; padding: 10px;">
                        <p><strong>Get the best experience by installing this app!</strong></p>
                        <ul style="list-style: none; padding: 0;">
                            <li>âœ… Works offline</li>
                            <li>âœ… Quick access from home screen</li>
                            <li>âœ… No browser address bar</li>
                            <li>âœ… Faster loading</li>
                            <li>âœ… Native app experience</li>
                        </ul>
                    </div>
                `,
                icon: 'info',
                showCancelButton: true,
                confirmButtonColor: '#4CAF50',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'ðŸ“¥ Install Now',
                cancelButtonText: 'Maybe Later',
                allowOutsideClick: false,
                customClass: {
                    container: 'install-prompt-container',
                    popup: 'install-prompt-popup'
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    installPWA();
                } else {
                    // User dismissed, clear flag so they can see it again later
                    localStorage.removeItem('installPromptShown');
                }
            });
        }

        function installPWA() {
            if (deferredPrompt) {
                // Show the browser's native install prompt
                deferredPrompt.prompt();

                // Wait for the user to respond to the prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                        if (typeof Swal !== 'undefined') {
                            Swal.fire({
                                title: 'Installed! ðŸŽ‰',
                                text: 'The app has been installed successfully. You can now use it offline!',
                                icon: 'success',
                                confirmButtonColor: '#4CAF50',
                                timer: 3000,
                                showConfirmButton: false
                            });
                        }
                    } else {
                        console.log('User dismissed the install prompt');
                    }
                    deferredPrompt = null;

                    // Hide install button
                    const installBtn = document.getElementById('installAppBtn');
                    if (installBtn) {
                        installBtn.style.display = 'none';
                    }
                });
            }
        }

        // Check if app is installed
        window.addEventListener('appinstalled', () => {
            console.log('PWA installed successfully');
            deferredPrompt = null;

            // Hide install button
            const installBtn = document.getElementById('installAppBtn');
            if (installBtn) {
                installBtn.style.display = 'none';
            }
        });

        // Handle URL shortcuts
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const action = urlParams.get('action');

            if (action === 'add') {
                setTimeout(() => addRow(), 500);
            } else if (action === 'export') {
                setTimeout(() => exportToExcel(), 500);
            }
        });
    </script>
    <script src="script.js"></script>
</body>

</html>